(function (n) { "use strict"; n.event.special.destroyed || (n.event.special.destroyed = { remove: function (n) { n.handler && n.handler() } }); n.fn.extend({ maxlength: function (t, i) { function f(n) { var t = n.charCodeAt(); return t ? t < 128 ? 1 : t < 2048 ? 2 : 3 : 0 } function e(n) { return n.split("").map(f).concat(0).reduce(function (n, t) { return n + t }) } function o(n) { var i = n.val(), r; return i = t.twoCharLinebreak ? i.replace(/\r(?!\n)|\n(?!\r)/g, "\r\n") : i.replace(new RegExp("\r?\n", "g"), "\n"), r = 0, t.utf8 ? e(i) : i.length } function v(n, i) { var r = n.val(), u, o, s; if (t.twoCharLinebreak && (r = r.replace(/\r(?!\n)|\n(?!\r)/g, "\r\n"), r[r.length - 1] === "\n" && (i -= r.length % 2)), t.utf8) { for (u = r.split("").map(f), o = 0, s = e(r) - i; o < s; o += u.pop()); i -= i - u.length } n.val(r.substr(0, i)) } function y(n, i, r) { var u = !0; return !t.alwaysShow && r - o(n) > i && (u = !1), u } function s(n, t) { return t - o(n) } function h(n, t) { t.css({ display: "block" }); n.trigger("maxlength.shown") } function p(n, i) { t.alwaysShow || (i.css({ display: "none" }), n.trigger("maxlength.hidden")) } function c(n, i, r) { var u = ""; return t.message ? u = typeof t.message == "function" ? t.message(n, i) : t.message.replace("%charsTyped%", r).replace("%charsRemaining%", i - r).replace("%charsTotal%", i) : (t.preText && (u += t.preText), u += t.showCharsTyped ? r : i - r, t.showMaxLength && (u += t.separator + i), t.postText && (u += t.postText)), u } function l(n, i, r, u) { u && (u.html(c(i.val(), r, r - n)), n > 0 ? y(i, t.threshold, r) ? h(i, u.removeClass(t.limitReachedClass).addClass(t.warningClass)) : p(i, u) : h(i, u.removeClass(t.warningClass).addClass(t.limitReachedClass))); t.customMaxAttribute && (n < 0 ? i.addClass("overmax") : i.removeClass("overmax")) } function w(t) { var i = t[0]; return n.extend({}, typeof i.getBoundingClientRect == "function" ? i.getBoundingClientRect() : { width: i.offsetWidth, height: i.offsetHeight }, t.offset()) } function b(i, r) { if (i && r) { var u = {}; n.each(["top", "bottom", "left", "right", "position"], function (n, i) { var r = t.placement[i]; typeof r != "undefined" && (u[i] = r) }); r.css(u); return } } function r(i, r) { var u = w(i); if (n.type(t.placement) === "function") { t.placement(i, r, u); return } if (n.isPlainObject(t.placement)) { b(t.placement, r); return } var o = i.outerWidth(), e = r.outerWidth(), s = r.width(), f = r.height(); t.appendToParent && (u.top -= i.parent().offset().top, u.left -= i.parent().offset().left); switch (t.placement) { case "bottom": r.css({ top: u.top + u.height, left: u.left + u.width / 2 - s / 2 }); break; case "top": r.css({ top: u.top - f, left: u.left + u.width / 2 - s / 2 }); break; case "left": r.css({ top: u.top + u.height / 2 - f / 2, left: u.left - s }); break; case "right": r.css({ top: u.top + u.height / 2 - f / 2, left: u.left + u.width }); break; case "bottom-right": r.css({ top: u.top + u.height, left: u.left + u.width }); break; case "top-right": r.css({ top: u.top - f, left: u.left + o }); break; case "top-left": r.css({ top: u.top - f, left: u.left - e }); break; case "bottom-left": r.css({ top: u.top + i.outerHeight(), left: u.left - e }); break; case "centered-right": r.css({ top: u.top + f / 2, left: u.left + o - e - 3 }); break; case "bottom-right-inside": r.css({ top: u.top + u.height, left: u.left + u.width - e }); break; case "top-right-inside": r.css({ top: u.top - f, left: u.left + o - e }); break; case "top-left-inside": r.css({ top: u.top - f, left: u.left }); break; case "bottom-left-inside": r.css({ top: u.top + i.outerHeight(), left: u.left }) } } function k() { return t.placement === "bottom-right-inside" || t.placement === "top-right-inside" || typeof t.placement == "function" || t.message && typeof t.message == "function" } function u(n) { var i = n.attr("maxlength") || t.customMaxAttribute, r; return t.customMaxAttribute && !t.allowOverMax && (r = n.attr(t.customMaxAttribute), (!i || r < i) && (i = r)), i || (i = n.attr("size")), i } var a = n("body"); return n.isFunction(t) && !i && (i = t, t = {}), t = n.extend({ showOnReady: !1, alwaysShow: !1, threshold: 10, warningClass: "label label-success", limitReachedClass: "label label-important label-danger", separator: " / ", preText: "", postText: "", showMaxLength: !0, placement: "bottom", message: null, showCharsTyped: !0, validate: !1, utf8: !1, appendToParent: !1, twoCharLinebreak: !0, customMaxAttribute: null, allowOverMax: !1 }, t), this.each(function () { function o() { var h = c(i.val(), e, "0"), o; e = u(i); f || (f = n('<span class="bootstrap-maxlength"><\/span>').css({ display: "none", position: "absolute", whiteSpace: "nowrap", zIndex: 1099 }).html(h)); i.is("textarea") && (i.data("maxlenghtsizex", i.outerWidth()), i.data("maxlenghtsizey", i.outerHeight()), i.mouseup(function () { (i.outerWidth() !== i.data("maxlenghtsizex") || i.outerHeight() !== i.data("maxlenghtsizey")) && r(i, f); i.data("maxlenghtsizex", i.outerWidth()); i.data("maxlenghtsizey", i.outerHeight()) })); t.appendToParent ? (i.parent().append(f), i.parent().css("position", "relative")) : a.append(f); o = s(i, u(i)); l(o, i, e, f); r(i, f) } var i = n(this), e, f; n(window).resize(function () { f && r(i, f) }); t.showOnReady ? i.ready(function () { o() }) : i.focus(function () { o() }); i.on("maxlength.reposition", function () { r(i, f) }); i.on("destroyed", function () { f && f.remove() }); i.on("blur", function () { f && !t.showOnReady && f.remove() }); i.on("input", function () { var n = u(i), o = s(i, n), h = !0; return t.validate && o < 0 ? (v(i, n), h = !1) : l(o, i, e, f), k() && r(i, f), h }) }) } }) })(jQuery);